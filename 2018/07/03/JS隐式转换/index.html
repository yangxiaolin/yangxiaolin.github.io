<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>JS隐式转换 | xiaolin Yang&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="声明  所有例子均在Safari(11.1), Chrome(67.0.3396.99), Node(v10.4.1)中测试过，如果在其他浏览器中有不一致，烦请指出。 开胃菜😋  12345678910111213[] + &amp;#123;&amp;#125; // &quot;[object Object]&quot;&amp;#123;&amp;#125; + [] // 0[] + [] // &quot;&quot;true + true + true">
<meta name="keywords" content="JS">
<meta property="og:type" content="article">
<meta property="og:title" content="JS隐式转换">
<meta property="og:url" content="http://xiaolinyang.com/2018/07/03/JS隐式转换/index.html">
<meta property="og:site_name" content="xiaolin Yang&#39;s blog">
<meta property="og:description" content="声明  所有例子均在Safari(11.1), Chrome(67.0.3396.99), Node(v10.4.1)中测试过，如果在其他浏览器中有不一致，烦请指出。 开胃菜😋  12345678910111213[] + &amp;#123;&amp;#125; // &quot;[object Object]&quot;&amp;#123;&amp;#125; + [] // 0[] + [] // &quot;&quot;true + true + true">
<meta property="og:updated_time" content="2018-10-17T05:59:43.816Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JS隐式转换">
<meta name="twitter:description" content="声明  所有例子均在Safari(11.1), Chrome(67.0.3396.99), Node(v10.4.1)中测试过，如果在其他浏览器中有不一致，烦请指出。 开胃菜😋  12345678910111213[] + &amp;#123;&amp;#125; // &quot;[object Object]&quot;&amp;#123;&amp;#125; + [] // 0[] + [] // &quot;&quot;true + true + true">
  
    <link rel="alternate" href="/atom.xml" title="xiaolin Yang&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">xiaolin Yang&#39;s blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://xiaolinyang.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-JS隐式转换" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/03/JS隐式转换/" class="article-date">
  <time datetime="2018-07-03T05:24:02.000Z" itemprop="datePublished">2018-07-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      JS隐式转换
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h1><p>  所有例子均在<font size="4" color="#03a9f4">Safari(11.1)</font>, <font size="4" color="#03a9f4">Chrome(67.0.3396.99)</font>, <font size="4" color="#03a9f4">Node(v10.4.1)</font>中测试过，如果在其他浏览器中有不一致，烦请指出。</p>
<h1 id="开胃菜😋"><a href="#开胃菜😋" class="headerlink" title="开胃菜😋"></a>开胃菜😋</h1>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[] + &#123;&#125; <span class="comment">// "[object Object]"</span></span><br><span class="line">&#123;&#125; + [] <span class="comment">// 0</span></span><br><span class="line">[] + [] <span class="comment">// ""</span></span><br><span class="line"><span class="literal">true</span> + <span class="literal">true</span> + <span class="literal">true</span> <span class="comment">// 3</span></span><br><span class="line"><span class="literal">true</span> - <span class="literal">true</span> <span class="comment">// 0</span></span><br><span class="line"><span class="literal">true</span> == <span class="number">1</span> <span class="comment">// true</span></span><br><span class="line"><span class="literal">true</span> === <span class="number">1</span> <span class="comment">// false</span></span><br><span class="line">! + [] + [] + ![] <span class="comment">// "truefalse"</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  ! + [] 这里的+是一元运算符</span></span><br><span class="line"><span class="comment">  ! + [] + [] + ![] =&gt; !(+[]) + [] + ![] =&gt; !(0) + [] + false =&gt; true + '' + false =&gt; 'truefalse'</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">[] == <span class="number">0</span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h1 id="JS的加号"><a href="#JS的加号" class="headerlink" title="JS的加号+"></a>JS的加号+</h1><ul>
<li><p>数字相加</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> + <span class="number">1</span>; <span class="comment">//2</span></span><br><span class="line"><span class="number">1</span> + <span class="literal">NaN</span>; <span class="comment">// NaN</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>字符串相加(两个运算元中只要有一个运算元是字符串，最后的结果就一定是字符串)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'1'</span> + <span class="string">'1'</span> <span class="comment">// '11'</span></span><br><span class="line"><span class="number">1</span>   + <span class="string">'1'</span> <span class="comment">// '11'</span></span><br><span class="line"><span class="string">'1'</span> + <span class="number">1</span> <span class="comment">// '11'</span></span><br><span class="line"><span class="number">1</span> + &#123;&#125; <span class="comment">// '1[object Object]'</span></span><br><span class="line"><span class="comment">//&#123;&#125;(A) 通过 ToPrimitive要转换成数字，则先调用&#123;&#125;(A)的valueOf方法，得到的还是&#123;&#125;(B)</span></span><br><span class="line"><span class="comment">//由于&#123;&#125;(B)不是原始数据类型，则调用&#123;&#125;(A)的toString方法，得到'[object Object]',</span></span><br><span class="line"><span class="comment">// 1 + '[object Object]' 则为 '1[object Object]'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>类型转换(其他类型转数字)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">+<span class="string">""</span> <span class="comment">// 0</span></span><br><span class="line">+[] <span class="comment">// 0</span></span><br><span class="line">+&#123;&#125; <span class="comment">// NaN</span></span><br><span class="line">+<span class="string">'123'</span> <span class="comment">// 123</span></span><br></pre></td></tr></table></figure>
<p>operand + operand = result</p>
</li>
<li>使用ToPrimitive运算转换左与右运算元为原始数据类型值(primitive)</li>
<li>在第1步转换后，如果有运算元出现原始数据类型是”字符串”类型值时，则另一运算元作强制转换为字符串，然后作字符串的连接运算(concatenation)</li>
<li>在其他情况时，所有运算元都会转换为原始数据类型的”数字”类型值，然后作数学的相加运算(addition)</li>
</ul>
<h1 id="JS-ToPrimitive方法"><a href="#JS-ToPrimitive方法" class="headerlink" title="JS ToPrimitive方法"></a>JS <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-toprimitive" target="_blank" rel="noopener">ToPrimitive</a>方法</h1><p>  input代表代入的值，而PreferredType可以是数字(Number)或字符串(String)其中一种。PreferredType代表”优先的”、”首选的”的要进行转换到哪一种原始类型，转换的步骤会依这里的值而有所不同。如果没有提供这个值也就是预设情况，则会设置转换的hint值为”default”。这个首选的转换原始类型的指示(hint值)，是在作内部转换时由JS视情况自动加上的，一般情况就是预设值。预设值的转换步骤与PreferredType为数字的转换步骤一致(Date对象列外，Date对象会覆盖PreferredType的默认行为，使得PreferredType的默认值为String)。</p>
<ul>
<li><p>PreferredType为数字(Number)</p>
<ul>
<li>如果input是原始数据类型，则直接返回input</li>
<li>否则，如果input是个对象时，则调用对象的valueOf()方法，如果能得到原始数据类型的值，则返回这个值</li>
<li>否则，如果input是个对象时，调用对象的toString()方法，如果能得到原始数据类型的值，则返回这个值</li>
<li>否则，抛出TypeError错误</li>
</ul>
</li>
<li><p>PreferredType为字符串(String)</p>
<ul>
<li>如果input是原始数据类型，则直接返回input</li>
<li>否则，如果input是个对象时，调用对象的toString()方法，如果能得到原始数据类型的值，则返回这个值</li>
<li>否则，如果input是个对象时，则调用对象的valueOf()方法，如果能得到原始数据类型的值，则返回这个值</li>
<li>否则，抛出TypeError错误</li>
</ul>
</li>
</ul>
<h1 id="Object-Array-Date-Function-的valueOf与toString转换结果"><a href="#Object-Array-Date-Function-的valueOf与toString转换结果" class="headerlink" title="Object, Array, Date, Function 的valueOf与toString转换结果"></a>Object, Array, Date, Function 的valueOf与toString转换结果</h1><ul>
<li><p>Object</p>
<ul>
<li>valueOf =&gt; 对象本身</li>
<li>toString =&gt; “[object Object]”</li>
</ul>
</li>
<li><p>Array</p>
<ul>
<li>valueOf =&gt; 数组本身</li>
<li>toString =&gt; 相当于调用Array.prototype.join</li>
</ul>
</li>
<li><p>Date</p>
<ul>
<li>valueOf =&gt; 给定的时间转为UNIX时间(自1 January 1970 00:00:00 UTC起算)，但是以微秒计算的数字值</li>
<li>toString =&gt; 本地化的时间字符串</li>
<li>Date对象在进行加号运算时，它会优先使用toString来进行转换，这与其他对象<font size="5" color="#f00">不同</font>（其他对象均为先调用valueOf）。要得出Date对象中的valueOf返回值，需要使用一元加号(+)，来强制转换它为数字类型</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">1</span> + (<span class="keyword">new</span> <span class="built_in">Date</span>()) <span class="comment">// "1Wed Jul 04 2018 09:20:47 GMT+0800 (中国标准时间)" //笔者当前时间</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Function</p>
<ul>
<li>valueOf =&gt; 函数本身</li>
<li>toString =&gt; 函数中包含的代码转为字符串值</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> someFunc = <span class="function"><span class="params">()</span> =&gt;</span> (&#123;&#125;)</span><br><span class="line"><span class="built_in">String</span>(someFunc) <span class="comment">// () =&gt; (&#123;&#125;)</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="Symbol"><a href="#Symbol" class="headerlink" title="Symbol"></a>Symbol</h1><p>  Symbol不算是一般的值也不是对象，它并没有内部自动转型的设计，所以完全不能直接用于加法运算，使用时会报错。</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">1</span> + <span class="built_in">Symbol</span>(<span class="string">'1'</span>) <span class="comment">// Uncaught TypeError: Cannot convert a Symbol value to a number</span></span><br><span class="line"><span class="string">'1'</span> + <span class="built_in">Symbol</span>(<span class="string">'1'</span>) <span class="comment">// Uncaught TypeError: Cannot convert a Symbol value to a string</span></span><br></pre></td></tr></table></figure>
<h1 id="⚠️-字符串在加号运算有最高的优先运算，与字符串相加必定是字符串连接运算。数字与其他类型作相加时，除了字符串会优先使用字符串连接运算-concatenation-的，其他都要依照数字为优先，所以除了字符串之外的其他原始数据类型，都要转换为数字来进行数学的相加运算。当数字与字符串以外的，其他原始数据类型直接使用加号运算时，就是转为数字再运算。"><a href="#⚠️-字符串在加号运算有最高的优先运算，与字符串相加必定是字符串连接运算。数字与其他类型作相加时，除了字符串会优先使用字符串连接运算-concatenation-的，其他都要依照数字为优先，所以除了字符串之外的其他原始数据类型，都要转换为数字来进行数学的相加运算。当数字与字符串以外的，其他原始数据类型直接使用加号运算时，就是转为数字再运算。" class="headerlink" title="⚠️ 字符串在加号运算有最高的优先运算，与字符串相加必定是字符串连接运算。数字与其他类型作相加时，除了字符串会优先使用字符串连接运算(concatenation)的，其他都要依照数字为优先，所以除了字符串之外的其他原始数据类型，都要转换为数字来进行数学的相加运算。当数字与字符串以外的，其他原始数据类型直接使用加号运算时，就是转为数字再运算。"></a>⚠️ 字符串在加号运算有最高的优先运算，与字符串相加必定是字符串连接运算。数字与其他类型作相加时，除了字符串会优先使用字符串连接运算(concatenation)的，其他都要依照数字为优先，所以除了字符串之外的其他原始数据类型，都要转换为数字来进行数学的相加运算。当数字与字符串以外的，其他原始数据类型直接使用加号运算时，就是转为数字再运算。</h1><h1 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h1>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;<span class="attr">b</span>:<span class="number">42</span>&#125;</span><br><span class="line"><span class="keyword">var</span> b = &#123;<span class="attr">b</span>:<span class="number">43</span>&#125;</span><br><span class="line"></span><br><span class="line">a &lt; b   <span class="comment">// false</span></span><br><span class="line">a == b  <span class="comment">// false</span></span><br><span class="line">a &gt; b   <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">a &lt;= b  <span class="comment">// true</span></span><br><span class="line">a &gt;= b  <span class="comment">// true</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  当比较运算符有不是原始数据的时候，会根据上面的 ToPrimitive 规则先转换为原始数据结构再进行比较</span></span><br><span class="line"><span class="comment">  使得 a &lt;= b  变成了 '[object Object]' &lt;= '[object Object]'。而字符串比较会一个一个字符比较charCode。故会得到true</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<h3 id="彩蛋-最近看到的"><a href="#彩蛋-最近看到的" class="headerlink" title="彩蛋(最近看到的)"></a>彩蛋(最近看到的)</h3><p>如果</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a == <span class="number">2</span> &amp;&amp; a == <span class="number">3</span> &amp;&amp; a == <span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>问<code>a</code>是什么?</p>
<p>答案在👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a = &#123;</span><br><span class="line">  x: <span class="number">1</span>,</span><br><span class="line">  toString() &#123;</span><br><span class="line">    <span class="keyword">this</span>.x += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.x</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://xiaolinyang.com/2018/07/03/JS隐式转换/" data-id="cjncqyu5r0001972nibgqsrhi" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JS/">JS</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/07/19/Array-prototype-reduce/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Array.prototype.reduce
        
      </div>
    </a>
  
  
    <a href="/2018/05/30/JS变量提升/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">JS变量提升</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS/">JS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS-Array-reduce/">JS Array reduce</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS-variable-Hoisting/">JS variable Hoisting</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript-this/">JavaScript this</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node-js/">Node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Timer/">Timer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js-闭包/">js 闭包</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/skill/">skill</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/JS/" style="font-size: 20px;">JS</a> <a href="/tags/JS-Array-reduce/" style="font-size: 10px;">JS Array reduce</a> <a href="/tags/JS-variable-Hoisting/" style="font-size: 10px;">JS variable Hoisting</a> <a href="/tags/JavaScript-this/" style="font-size: 10px;">JavaScript this</a> <a href="/tags/Node-js/" style="font-size: 10px;">Node.js</a> <a href="/tags/Timer/" style="font-size: 10px;">Timer</a> <a href="/tags/js/" style="font-size: 10px;">js</a> <a href="/tags/js-闭包/" style="font-size: 10px;">js 闭包</a> <a href="/tags/skill/" style="font-size: 10px;">skill</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/08/09/this 的那些事/">this 的那些事</a>
          </li>
        
          <li>
            <a href="/2018/07/26/js闭包实现累加/">js闭包实现累加</a>
          </li>
        
          <li>
            <a href="/2018/07/19/Array-prototype-reduce/">Array.prototype.reduce</a>
          </li>
        
          <li>
            <a href="/2018/07/03/JS隐式转换/">JS隐式转换</a>
          </li>
        
          <li>
            <a href="/2018/05/30/JS变量提升/">JS变量提升</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 xiaolin Yang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>